# Upstream configuration for website {{.WebsiteID}}
# Generated by CMDB Agent at {{.GeneratedAt}}

upstream {{.UpstreamName}} {
{{- range .Addresses}}
{{- if .Enabled}}
    server {{.Address}} weight={{.Weight}}{{if eq .Role "backup"}} backup{{end}};
{{- end}}
{{- end}}
{{- if eq (len .Addresses) 0}}
    # No upstream addresses configured
    server 127.0.0.1:65535; # Placeholder to prevent nginx error
{{- end}}
}
